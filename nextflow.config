includeConfig './conf/base.config'

params {
    // Input/output options
    input                       = null
    external_protein_fastas     = null
    eggnogmapper_db_dir         = null
    eggnogmapper_tax_scope      = null
    fastq                       = null
    liftoff_annotations         = null
    outdir                      = "./results"

    // Repeat annotation options
    repeat_annotator            = 'repeatmodeler'
    save_annotated_te_lib       = false
    edta_is_sensitive           = false
    repeatmasker_save_outputs   = false

    // RNASeq pre-processing options
    skip_fastqc                 = false
    skip_fastp                  = false
    min_trimmed_reads           = 10000
    extra_fastp_args            = ""
    save_trimmed                = false
    remove_ribo_rna             = false
    save_non_ribo_reads         = false
    ribo_database_manifest      = "${projectDir}/assets/rrna-db-defaults.txt"

    // RNAseq alignment options
    star_max_intron_length      = 16000
    star_align_extra_args       = ""
    star_save_outputs           = false
    save_cat_bam                = false

    // Annotation options
    braker_extra_args           = ""
    braker_allow_isoforms       = true
    liftoff_coverage            = 0.9
    liftoff_identity            = 0.9
    eggnogmapper_evalue         = 0.00001
    eggnogmapper_pident         = 35
    eggnogmapper_purge_nohits   = false

    // Max job request options
    max_cpus                    = 12
    max_memory                  = '200.GB'
    max_time                    = '7.day'

    // Infrastructure options
    validationSkipDuplicateCheck= true
    validationS3PathCheck       = true
}

manifest {
    name                        = 'pangene'
    author                      = """Usman Rashid, Jason Shiller"""
    homePage                    = 'https://github.com/PlantandFoodResearch/pan-gene'
    description                 = """A NextFlow pipeline for pan-genome annotation"""
    mainScript                  = 'main.nf'
    nextflowVersion             = '!>=23.04.4'
    version                     = '0.2.0'
    doi                         = ''
}

def trace_timestamp             = new java.util.Date().format( 'yyyy-MM-dd_HH-mm-ss')
timeline {
    enabled                     = true
    file                        = "${params.outdir}/pipeline_info/execution_timeline_${trace_timestamp}.html"
}
report {
    enabled                     = true
    file                        = "${params.outdir}/pipeline_info/execution_report_${trace_timestamp}.html"
}
trace {
    enabled                     = true
    file                        = "${params.outdir}/pipeline_info/execution_trace_${trace_timestamp}.txt"
}

plugins {
    id 'nf-validation@1.1.3'
}

includeConfig './conf/modules.config'
